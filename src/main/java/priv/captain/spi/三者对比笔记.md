## 1ï¸âƒ£ Java SPI (Service Provider Interface)

**åŸç†**ï¼š

* Java åŸç”Ÿæœºåˆ¶ï¼ŒåŸºäº `META-INF/services/æ¥å£å…¨é™å®šå` æ–‡ä»¶æ³¨å†Œå®ç°ç±»ã€‚
* `ServiceLoader.load(æ¥å£.class)` åŠ¨æ€åŠ è½½å®ç°ç±»ã€‚

**ç‰¹ç‚¹**ï¼š

* **æ ‡å‡†åŒ–**ï¼šJava æä¾›çš„åŸç”Ÿæ¥å£ã€‚
* **è§£è€¦**ï¼šæ¨¡å—é—´åªä¾èµ–æ¥å£ï¼Œä¸ä¾èµ–å®ç°ã€‚
* **é™æ€åŠ è½½**ï¼šå¯åŠ¨æ—¶æ‰«æ `META-INF/services`ã€‚
* **æœ‰é™çš„æ‰©å±•èƒ½åŠ›**ï¼šä¸èƒ½ç›´æ¥æ§åˆ¶åŠ è½½é¡ºåºï¼ˆJava 9+ å¯ç»“åˆ `@Priority`ï¼‰ã€‚

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```java
// æ–‡ä»¶ï¼šMETA-INF/services/com.example.MyService
com.example.impl.MyServiceImpl1
com.example.impl.MyServiceImpl2

// åŠ è½½
ServiceLoader<MyService> loader = ServiceLoader.load(MyService.class);
for (MyService service : loader) {
    service.execute();
}
```

**ä¼˜ç‚¹**ï¼šæ ‡å‡†ã€ç®€å•ï¼ŒJDK è‡ªå¸¦
**ç¼ºç‚¹**ï¼šé¡ºåºæ§åˆ¶å¼±ã€çµæ´»æ€§å·®

---

## 2ï¸âƒ£ Spring SPI (SpringFactoriesLoader)

**åŸç†**ï¼š

* Spring Boot ç”¨ `META-INF/spring.factories` æ–‡ä»¶æ³¨å†Œå®ç°ç±»æˆ–é…ç½®ç±»ã€‚
* `SpringFactoriesLoader.loadFactories(æ¥å£.class, classLoader)` è¿›è¡ŒåŠ è½½ã€‚

**ç‰¹ç‚¹**ï¼š

* **çµæ´»**ï¼šæ”¯æŒ `@Order` æ§åˆ¶åŠ è½½é¡ºåºã€‚
* **æ‡’åŠ è½½/æ¡ä»¶åŠ è½½**ï¼šå¯ç»“åˆ `@ConditionalOnClass`ã€`@ConditionalOnMissingBean` ç­‰æ³¨è§£ã€‚
* **å¸¸ç”¨äºè‡ªåŠ¨é…ç½®**ï¼šSpring Boot çš„ Starterã€è‡ªåŠ¨è£…é…éƒ½æ˜¯åŸºäºè¿™ä¸ªæœºåˆ¶ã€‚

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```properties
# META-INF/spring.factories
com.example.MyService=com.example.impl.MyServiceImpl1,com.example.impl.MyServiceImpl2
```

```java
List<MyService> services = SpringFactoriesLoader.loadFactories(MyService.class, getClass().getClassLoader());
services.forEach(MyService::execute);
```

**ä¼˜ç‚¹**ï¼šé¡ºåºå¯æ§ã€å¯æ¡ä»¶åŒ–ã€é€‚åˆè‡ªåŠ¨é…ç½®
**ç¼ºç‚¹**ï¼šä¾èµ– Spring æ¡†æ¶

---

## 3ï¸âƒ£ Dubbo SPI

**åŸç†**ï¼š

* Dubbo æä¾›æ‰©å±•æ¥å£æœºåˆ¶ï¼ŒåŸºäº `META-INF/dubbo/æ¥å£å…¨é™å®šå` æ–‡ä»¶æ³¨å†Œå®ç°ç±»ã€‚
* æ”¯æŒ `@Activate` æ§åˆ¶è‡ªåŠ¨æ¿€æ´»ã€æ’åºã€æ¡ä»¶è¿‡æ»¤ã€‚
* æœ‰æ‰©å±•ç‚¹ï¼ˆExtensionLoaderï¼‰æœºåˆ¶ã€‚

**ç‰¹ç‚¹**ï¼š

* **æ”¯æŒè‡ªåŠ¨æ¿€æ´»**ï¼šé€šè¿‡ `@Activate` æŒ‡å®š groupã€value ç­‰æ¡ä»¶ã€‚
* **å»¶è¿ŸåŠ è½½**ï¼šæŒ‰éœ€åŠ è½½æ‰©å±•å®ç°ã€‚
* **å¯æ’æ‹”**ï¼šå¯æŒ‰æ¡ä»¶é€‰æ‹©é»˜è®¤å®ç°æˆ–è‡ªå®šä¹‰å®ç°ã€‚

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```properties
# META-INF/dubbo/com.example.MyService
impl1=com.example.impl.MyServiceImpl1
impl2=com.example.impl.MyServiceImpl2
```

```java
MyService service = ExtensionLoader.getExtensionLoader(MyService.class).getExtension("impl1");
service.execute();
```

**ä¼˜ç‚¹**ï¼šæ¡ä»¶æ¿€æ´»å¼ºã€æ”¯æŒå¤šå®ç°ç®¡ç†ã€å»¶è¿ŸåŠ è½½
**ç¼ºç‚¹**ï¼šåªèƒ½ç”¨äº Dubbo ä½“ç³»ï¼Œä¾èµ– Dubbo

---

## 4ï¸âƒ£ ä¸‰è€…å¯¹æ¯”æ€»ç»“

| ç‰¹æ€§      | Java SPI           | Spring SPI (SpringFactoriesLoader)  | Dubbo SPI          |
| ------- | ------------------ | ----------------------------------- | ------------------ |
| é…ç½®æ–‡ä»¶è·¯å¾„  | META-INF/services  | META-INF/spring.factories           | META-INF/dubbo/æ¥å£å |
| æ³¨è§£/é¡ºåºæ§åˆ¶ | Java 9+: @Priority | @Order                              | @Activate          |
| æ¡ä»¶åŒ–/æ‡’åŠ è½½ | ä¸æ”¯æŒ                | æ”¯æŒ @Conditional                     | æ”¯æŒ group/value æ¡ä»¶  |
| åŠ è½½æ–¹å¼    | ServiceLoader      | SpringFactoriesLoader.loadFactories | ExtensionLoader    |
| åº”ç”¨åœºæ™¯    | JDK æ ‡å‡†æ’ä»¶æœºåˆ¶         | Spring Boot è‡ªåŠ¨é…ç½®ã€æ‰©å±•                 | Dubbo æ¡†æ¶æ‰©å±•         |
| çµæ´»æ€§     | ä½                  | é«˜                                   | é«˜                  |

---

ğŸ’¡ **æ ¸å¿ƒç†è§£**ï¼š

1. **Java SPI** â†’ æ ‡å‡†ã€ç®€å•ã€è½»é‡ï¼Œä½†é¡ºåºå’Œæ¡ä»¶èƒ½åŠ›å¼±ã€‚
2. **Spring SPI** â†’ è‡ªåŠ¨é…ç½®åˆ©å™¨ï¼Œå¯æ§åˆ¶åŠ è½½é¡ºåºï¼Œæ¡ä»¶åŒ–èƒ½åŠ›å¼ºã€‚
3. **Dubbo SPI** â†’ é«˜åº¦æ‰©å±•åŒ–ï¼Œå¯æ¡ä»¶æ¿€æ´»ï¼Œå¤šå®ç°ç®¡ç†æ–¹ä¾¿ã€‚

---