### ğŸ“˜ Java é¢è¯•å¤ä¹ ç¬”è®°ï¼šLinkedHashMap

### âœ… ä¸€ã€æ¦‚å¿µç®€ä»‹

**LinkedHashMap æ˜¯ä»€ä¹ˆï¼Ÿ**

`LinkedHashMap` æ˜¯ `java.util` åŒ…ä¸‹çš„ä¸€ä¸ª Map æ¥å£å®ç°ï¼Œå®ƒç»§æ‰¿è‡ª `HashMap`ã€‚å®ƒç»“åˆäº†å“ˆå¸Œè¡¨å’ŒåŒå‘é“¾è¡¨çš„ä¼˜ç‚¹ï¼Œæ—¢èƒ½åƒ `HashMap` ä¸€æ ·æä¾›å¿«é€Ÿçš„é”®å€¼æŸ¥æ‰¾ï¼ˆO(1)ï¼‰ï¼Œåˆèƒ½åƒ `LinkedList` ä¸€æ ·ä¿æŒå…ƒç´ çš„**æ’å…¥é¡ºåº**æˆ–**è®¿é—®é¡ºåº**ã€‚

å¯ä»¥æŠŠ `LinkedHashMap` æƒ³è±¡æˆä¸€ä¸ª**æœ‰åºçš„ HashMap**ï¼š

  - å®ƒåœ¨ `HashMap` çš„åŸºç¡€ä¸Šï¼Œä¸ºæ¯ä¸ªé”®å€¼å¯¹ï¼ˆ`Entry`ï¼‰å¢åŠ äº†ä¸€å¯¹å‰åæŒ‡é’ˆã€‚
  - è¿™äº›æŒ‡é’ˆå°†æ‰€æœ‰é”®å€¼å¯¹è¿æ¥æˆäº†ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œä»è€Œç»´æŒäº†ç‰¹å®šçš„é¡ºåºã€‚

**ä¸ºä»€ä¹ˆç”¨ï¼Ÿ**

ğŸ¯ **æ ¸å¿ƒç›®çš„ï¼š** åœ¨ä¿è¯é«˜æ•ˆæŸ¥æ‰¾çš„åŒæ—¶ï¼Œç»´æŒå…ƒç´ çš„æ’å…¥æˆ–è®¿é—®é¡ºåºã€‚

  * **ä¿æŒé¡ºåºï¼š** åœ¨éœ€è¦éå† Map ä¸”å¸Œæœ›é¡ºåºå¯æ§çš„åœºæ™¯ä¸‹ï¼Œ`LinkedHashMap` æ˜¯æ¯” `HashMap` æ›´å¥½çš„é€‰æ‹©ã€‚
  * **å®ç° LRU ç¼“å­˜ï¼š** `LinkedHashMap` æä¾›äº†ä¸€ä¸ªç‰¹æ®Šçš„æ„é€ å‡½æ•°ï¼Œå¯ä»¥ä½¿å…¶æŒ‰ç…§å…ƒç´ çš„è®¿é—®é¡ºåºè¿›è¡Œæ’åºã€‚é€šè¿‡é‡å†™ `removeEldestEntry()` æ–¹æ³•ï¼Œå®ƒå¯ä»¥éå¸¸æ–¹ä¾¿åœ°å®ç°ä¸€ä¸ªç®€å•çš„ **LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç¼“å­˜**æ·˜æ±°ç­–ç•¥ã€‚

-----

### ğŸ”¹ äºŒã€åº•å±‚åŸç†ä¸æ•°æ®ç»“æ„

`LinkedHashMap` çš„åº•å±‚æ•°æ®ç»“æ„æ˜¯**å“ˆå¸Œè¡¨ + åŒå‘é“¾è¡¨**ã€‚

#### 1\. ç»§æ‰¿è‡ª `HashMap`

  - `LinkedHashMap` ç»§æ‰¿äº† `HashMap` çš„æ‰€æœ‰ç‰¹æ€§ï¼ŒåŒ…æ‹¬æ•°ç»„ã€é“¾è¡¨ã€çº¢é»‘æ ‘ç­‰ã€‚
  - å®ƒä¿ç•™äº† `HashMap` çš„æ ¸å¿ƒæŸ¥æ‰¾æœºåˆ¶ï¼Œå³é€šè¿‡å“ˆå¸Œå€¼å¿«é€Ÿå®šä½åˆ°æ•°ç»„ç´¢å¼•ã€‚

#### 2\. å¢å¼ºçš„åŒå‘é“¾è¡¨

  - `LinkedHashMap` åœ¨ `HashMap` çš„ `Node` èŠ‚ç‚¹åŸºç¡€ä¸Šï¼Œå¢åŠ äº†ä¸€ä¸ª `before` å’Œä¸€ä¸ª `after` æŒ‡é’ˆã€‚
  - è¿™äº›æŒ‡é’ˆå°†æ‰€æœ‰ `Node` èŠ‚ç‚¹ï¼ˆå³é”®å€¼å¯¹ï¼‰æŒ‰é¡ºåºä¸²è”èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªåŒå‘é“¾è¡¨ã€‚
  - é“¾è¡¨çš„å¤´ï¼ˆ`head`ï¼‰æŒ‡å‘æœ€æ—©æ’å…¥æˆ–æœ€è¿‘æœ€å°‘è®¿é—®çš„èŠ‚ç‚¹ï¼Œå°¾ï¼ˆ`tail`ï¼‰æŒ‡å‘æœ€æ–°æ’å…¥æˆ–æœ€è¿‘è®¿é—®çš„èŠ‚ç‚¹ã€‚

#### 3\. ä¸¤ç§æ’åºæ¨¡å¼

`LinkedHashMap` æœ‰ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„æˆå‘˜å˜é‡ `accessOrder`ï¼Œç”¨äºæ§åˆ¶å…¶æ’åºæ¨¡å¼ã€‚

  * **æ’å…¥é¡ºåºï¼ˆ`accessOrder = false`ï¼Œé»˜è®¤ï¼‰ï¼š**
      - å½“ä¸€ä¸ªæ–°å…ƒç´ è¢«æ’å…¥æ—¶ï¼Œå®ƒä¼šè¢«æ·»åŠ åˆ°é“¾è¡¨çš„å°¾éƒ¨ã€‚
      - å…ƒç´ çš„é¡ºåºä¸å®ƒä»¬è¢«æ”¾å…¥ Map çš„é¡ºåºä¸€è‡´ã€‚
  * **è®¿é—®é¡ºåºï¼ˆ`accessOrder = true`ï¼‰ï¼š**
      - å½“ä½ ä½¿ç”¨ `get()` æˆ– `put()` æ–¹æ³•è®¿é—®ä¸€ä¸ªé”®å€¼å¯¹æ—¶ï¼Œè¿™ä¸ªé”®å€¼å¯¹ä¼šè¢«ç§»åŠ¨åˆ°é“¾è¡¨çš„å°¾éƒ¨ã€‚
      - è¿™æ ·ï¼Œé“¾è¡¨çš„å¤´éƒ¨æ€»æ˜¯æœ€è¿‘æœ€å°‘è®¿é—®çš„å…ƒç´ ï¼Œéå¸¸é€‚åˆå®ç° LRU ç¼“å­˜ã€‚

-----

### âœ… ä¸‰ã€å¸¸ç”¨æ–¹å¼ + ä»£ç ç¤ºä¾‹

`LinkedHashMap` çš„ç”¨æ³•ä¸ `HashMap` ç±»ä¼¼ï¼Œä½†å…¶æ’åºç‰¹æ€§æ˜¯å…³é”®ã€‚

#### 1\. é»˜è®¤çš„æ’å…¥é¡ºåºæ¨¡å¼

```java
import java.util.LinkedHashMap;
import java.util.Map;

public class LinkedHashMapExample {
    public static void main(String[] args) {
        // åˆ›å»ºä¸€ä¸ª LinkedHashMapï¼Œä½¿ç”¨é»˜è®¤çš„æ’å…¥é¡ºåºæ¨¡å¼
        Map<String, String> map = new LinkedHashMap<>();
        
        map.put("key1", "value1");
        map.put("key2", "value2");
        map.put("key3", "value3");
        
        System.out.println("æŒ‰æ’å…¥é¡ºåºéå† LinkedHashMap:");
        for (Map.Entry<String, String> entry : map.entrySet()) {
            System.out.println(entry.getKey() + " = " + entry.getValue());
        }
        
        // å³ä½¿è®¿é—®å…ƒç´ ï¼Œé¡ºåºä¹Ÿä¸ä¼šæ”¹å˜
        map.get("key2");
        System.out.println("\nè®¿é—® key2 åï¼Œå†æ¬¡éå†ï¼š");
        for (Map.Entry<String, String> entry : map.entrySet()) {
            System.out.println(entry.getKey() + " = " + entry.getValue());
        }
    }
}
```

#### 2\. è®¿é—®é¡ºåºæ¨¡å¼ä¸ LRU ç¼“å­˜å®ç°

```java
import java.util.LinkedHashMap;
import java.util.Map;

public class LRUCache<K, V> extends LinkedHashMap<K, V> {
    private final int capacity;

    // æ„é€ å‡½æ•°ï¼Œè®¾ç½®å®¹é‡å’Œè®¿é—®é¡ºåº
    public LRUCache(int capacity) {
        // initialCapacity, loadFactor, accessOrder
        super(capacity, 0.75f, true);
        this.capacity = capacity;
    }

    // é‡å†™æ­¤æ–¹æ³•ï¼Œå½“è¿”å› true æ—¶ï¼Œä¼šåˆ é™¤æœ€è€çš„é”®å€¼å¯¹
    @Override
    protected boolean removeEldestEntry(Map.Entry<K, V> eldest) {
        // å½“ Map çš„å¤§å°è¶…è¿‡å®¹é‡æ—¶ï¼Œè¿”å› trueï¼Œè§¦å‘åˆ é™¤æœ€è€çš„å…ƒç´ 
        return size() > capacity;
    }

    public static void main(String[] args) {
        LRUCache<Integer, String> cache = new LRUCache<>(3);
        
        cache.put(1, "value1");
        cache.put(2, "value2");
        cache.put(3, "value3");
        System.out.println("åˆå§‹ç¼“å­˜: " + cache); // {1=value1, 2=value2, 3=value3}
        
        // è®¿é—® key2ï¼Œå®ƒä¼šç§»åŠ¨åˆ°é“¾è¡¨å°¾éƒ¨
        cache.get(2); 
        System.out.println("è®¿é—® key2 å: " + cache); // {1=value1, 3=value3, 2=value2}
        
        // æ’å…¥ key4ï¼Œè¶…è¿‡å®¹é‡ï¼Œæœ€è€çš„å…ƒç´ ï¼ˆkey1ï¼‰è¢«ç§»é™¤
        cache.put(4, "value4");
        System.out.println("æ’å…¥ key4 å: " + cache); // {3=value3, 2=value2, 4=value4}
    }
}
```

### ğŸ” å››ã€çœŸå®é¢è¯•é«˜é¢‘é—®é¢˜ + æ·±åº¦è§£æ

**1. `LinkedHashMap` å’Œ `HashMap` æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

  * **æ ‡å‡†ç­”æ¡ˆï¼š** `LinkedHashMap` åœ¨ `HashMap` çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡ä¸€ä¸ªåŒå‘é“¾è¡¨é¢å¤–ç»´æŠ¤äº†å…ƒç´ çš„**æ’å…¥é¡ºåº**ï¼ˆæˆ–è®¿é—®é¡ºåºï¼‰ï¼Œè€Œ `HashMap` æ˜¯æ— åºçš„ã€‚
  * **æ€§èƒ½ï¼š** `LinkedHashMap` çš„ `put()`ã€`get()`ã€`remove()` ç­‰æ“ä½œçš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¾ç„¶æ˜¯ O(1)ï¼Œä½†ç”±äºéœ€è¦ç»´æŠ¤é“¾è¡¨ï¼Œå…¶æ€§èƒ½ä¼šç•¥ä½äº `HashMap`ã€‚

**2. `LinkedHashMap` å’Œ `TreeMap` æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**

  * **æ ‡å‡†ç­”æ¡ˆï¼š**
      * **åº•å±‚å®ç°ï¼š** `LinkedHashMap` åŸºäº**å“ˆå¸Œè¡¨ + åŒå‘é“¾è¡¨**ï¼Œ`TreeMap` åŸºäº**çº¢é»‘æ ‘**ã€‚
      * **é¡ºåºï¼š** `LinkedHashMap` ä¿æŒ**æ’å…¥é¡ºåº**æˆ–**è®¿é—®é¡ºåº**ï¼Œ`TreeMap` ä¿æŒ**è‡ªç„¶æ’åº**æˆ–**è‡ªå®šä¹‰æ’åº**ã€‚
      * **æ€§èƒ½ï¼š** `LinkedHashMap` çš„åŸºæœ¬æ“ä½œå¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼Œ`TreeMap` ä¸º O(log n)ã€‚
  * **é€‰æ‹©ï¼š** å¦‚æœä½ éœ€è¦ä¿æŒæ’å…¥é¡ºåºï¼Œç”¨ `LinkedHashMap`ã€‚å¦‚æœä½ éœ€è¦æŒ‰é”®è¿›è¡Œæ’åºï¼Œç”¨ `TreeMap`ã€‚

**3. å¦‚ä½•ç”¨ `LinkedHashMap` å®ç° LRU ç¼“å­˜ï¼Ÿ**

  * **æ ‡å‡†ç­”æ¡ˆï¼š**
    1.  åˆ›å»ºä¸€ä¸ª `LinkedHashMap` å®ä¾‹ï¼Œå¹¶ä½¿ç”¨å…¶å¸¦ `accessOrder=true` çš„æ„é€ å‡½æ•°ï¼Œä½¿å…¶æŒ‰ç…§è®¿é—®é¡ºåºæ’åºã€‚
    2.  é‡å†™ `LinkedHashMap` çš„ `protected boolean removeEldestEntry(Map.Entry<K, V> eldest)` æ–¹æ³•ã€‚
    3.  åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œåˆ¤æ–­å½“å‰ Map çš„å¤§å°æ˜¯å¦è¶…è¿‡äº†é¢„è®¾çš„å®¹é‡ï¼Œå¦‚æœè¶…è¿‡åˆ™è¿”å› `true`ï¼Œ`LinkedHashMap` ä¼šè‡ªåŠ¨ç§»é™¤é“¾è¡¨å¤´éƒ¨æœ€è€çš„é‚£ä¸ªå…ƒç´ ã€‚

**4. `LinkedHashMap` æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ**

  * **æ ‡å‡†ç­”æ¡ˆï¼š** `LinkedHashMap` å’Œ `HashMap` ä¸€æ ·ï¼Œéƒ½æ˜¯**çº¿ç¨‹ä¸å®‰å…¨**çš„ã€‚
  * **è§£å†³æ–¹æ¡ˆï¼š** åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ `Collections.synchronizedMap()` æ–¹æ³•æ¥è·å–ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ `LinkedHashMap` è§†å›¾ï¼Œæˆ–è€…ä½¿ç”¨ `ConcurrentHashMap`ï¼Œä½†åè€…ä¸ä¿ç•™é¡ºåºã€‚

### ğŸ’¡ äº”ã€å£è¯€ + è¡¨æ ¼/å›¾ç¤ºè¾…åŠ©è®°å¿†

**`LinkedHashMap` å£è¯€**

> **å“ˆå¸Œè¡¨ï¼ŒåŒå‘é“¾ã€‚**
> **æŸ¥æ‰¾å¿«ï¼Œé¡ºåºåœ¨ã€‚**
> **LRUï¼Œé å®ƒå»ºã€‚**
> **çº¿ç¨‹ä¸å®‰å…¨ï¼Œåˆ«ä¹±ç”¨ã€‚**

**Map ä¸‰å…„å¼Ÿæ ¸å¿ƒç‰¹æ€§å¯¹æ¯”**

| ç‰¹æ€§ | **`HashMap`** | **`LinkedHashMap`** | **`TreeMap`** |
| :--- | :--- | :--- | :--- |
| **åº•å±‚æ•°æ®ç»“æ„**| å“ˆå¸Œè¡¨ | å“ˆå¸Œè¡¨ + åŒå‘é“¾è¡¨ | çº¢é»‘æ ‘ |
| **å…ƒç´ é¡ºåº** | æ— åº | æ’å…¥é¡ºåºæˆ–è®¿é—®é¡ºåº | è‡ªç„¶æ’åºæˆ–è‡ªå®šä¹‰æ’åº |
| **æ€§èƒ½** | æœ€ä½³ (O(1)) | è‰¯å¥½ (O(1)) | è¾ƒå·® (O(log n)) |
| **æ˜¯å¦çº¿ç¨‹å®‰å…¨**| å¦ | å¦ | å¦ |
| **ä¸»è¦åº”ç”¨** | å¿«é€ŸæŸ¥æ‰¾ | é¡ºåºéå†æˆ– LRU ç¼“å­˜ | æŒ‰é”®æ’åº |

-----

### ğŸ å…­ã€å»ºè®® + è¯¯åŒºæé†’

**è¯¯åŒºæé†’**

1.  **å¿˜è®°æ‰‹åŠ¨è®¾ç½® `accessOrder=true`ï¼š** é»˜è®¤æƒ…å†µä¸‹ï¼Œ`LinkedHashMap` æ˜¯æŒ‰æ’å…¥é¡ºåºæ’åˆ—çš„ã€‚å¦‚æœä½ æƒ³å®ç° LRU ç¼“å­˜ï¼Œå¿…é¡»åœ¨æ„é€ å‡½æ•°ä¸­æ˜ç¡®æŒ‡å®š `true`ã€‚
2.  **åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä½¿ç”¨ï¼š** è¿™æ˜¯ä¸€ä¸ªå¸¸è§é”™è¯¯ï¼Œ`LinkedHashMap` æœ¬èº«ä¸æä¾›åŒæ­¥ä¿è¯ï¼Œå¦‚æœå¤šçº¿ç¨‹è®¿é—®ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚

**ä½¿ç”¨å»ºè®®**

1.  **æ ¹æ®éœ€æ±‚é€‰æ‹©ï¼š** å½“ä½ æ—¢éœ€è¦ `Map` çš„åŠŸèƒ½ï¼Œåˆéœ€è¦ä¿æŒå…ƒç´ çš„æ’å…¥é¡ºåºæ—¶ï¼Œ`LinkedHashMap` æ˜¯æœ€åˆé€‚çš„é€‰æ‹©ã€‚
2.  **LRU ç¼“å­˜ï¼š** `LinkedHashMap` æ˜¯å®ç°ç®€å• LRU ç¼“å­˜çš„ç»ä½³å·¥å…·ã€‚ä½†å¦‚æœéœ€è¦æ›´é«˜çº§çš„å¹¶å‘åŠŸèƒ½ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘å…¶ä»–ä¸“ä¸šçš„ç¼“å­˜æ¡†æ¶ã€‚
3.  **çº¿ç¨‹å®‰å…¨ï¼š** å¦‚æœåœ¨å¹¶å‘åœºæ™¯ä¸‹ä½¿ç”¨ `LinkedHashMap`ï¼Œè¯·åŠ¡å¿…è¿›è¡Œå¤–éƒ¨åŒæ­¥ï¼Œæˆ–è€…è€ƒè™‘ä½¿ç”¨æ”¯æŒå¹¶å‘çš„æ›¿ä»£æ–¹æ¡ˆã€‚